module.exports=[73853,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(75320),e=a.i(53131),f=a.i(50944),g=a.i(70106);let h=(0,g.default)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),i=(0,g.default)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),j=(0,g.default)("arrow-right",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);var k=a.i(38246);function l(){let a,{user:g,loading:l}=(0,e.useAuth)(),m=(0,f.useRouter)(),n=(0,f.useParams)(),[o,p]=(0,c.useState)(null),[q,r]=(0,c.useState)(180),[s,t]=(0,c.useState)(0),[u,v]=(0,c.useState)(!1),[w,x]=(0,c.useState)(!1),y=(0,c.useRef)(null),z=(0,c.useRef)(null);(0,c.useEffect)(()=>(l||g||m.push("/login"),g&&n.id&&A(),()=>{y.current&&clearInterval(y.current),z.current&&clearInterval(z.current)}),[g,l,n.id]);let A=async()=>{try{let a=n.id,[b,c]=await Promise.all([d.default.get(`/chapters/${a}`),d.default.get("/progress")]);p(b.data);let e=c.data.find(b=>b.chapterId===parseInt(a));if(e)if(v(e.completed),e.completed)x(!0),r(0);else{t(e.timeSpent);let a=Math.max(0,180-e.timeSpent);r(a),0===a?x(!0):B()}else B()}catch(a){console.error(a)}},B=()=>{y.current=setInterval(()=>{r(a=>a<=1?(x(!0),y.current&&clearInterval(y.current),0):a-1)},1e3),z.current=setInterval(()=>{C(10)},1e4)},C=async a=>{try{await d.default.post("/progress/update",{chapterId:n.id,timeIncrement:a})}catch(a){console.error("Progress save fail",a)}},D=async()=>{try{await d.default.post("/progress/complete",{chapterId:n.id}),v(!0),m.push("/dashboard")}catch(a){alert("Jeszcze nie minęło wystarczająco dużo czasu lub błąd serwera.")}};return o?(0,b.jsxs)("div",{className:"max-w-4xl mx-auto space-y-8 pt-32 pb-20 px-6",children:[(0,b.jsx)(k.default,{href:"/dashboard",className:"text-amber-600 hover:text-amber-700 hover:underline font-medium inline-flex items-center",children:"← Powrót do kursu"}),(0,b.jsxs)("div",{className:"bg-white p-8 rounded-2xl shadow-lg border border-stone-200",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,b.jsx)("h1",{className:"text-3xl font-bold text-slate-900",children:o.title}),!u&&(0,b.jsxs)("div",{className:`flex items-center space-x-2 px-4 py-2 rounded-full font-mono text-lg shadow-sm
                    ${w?"bg-green-100 text-green-700 ring-1 ring-green-200":"bg-amber-100 text-amber-800 ring-1 ring-amber-200"}`,children:[(0,b.jsx)(h,{className:"h-5 w-5"}),(0,b.jsx)("span",{children:w?"Czas minął!":(a=Math.floor(q/60),`${a}:${(q%60).toString().padStart(2,"0")}`)})]}),u&&(0,b.jsxs)("div",{className:"flex items-center space-x-2 px-4 py-2 bg-green-100 text-green-700 rounded-full ring-1 ring-green-200",children:[(0,b.jsx)(i,{className:"h-5 w-5"}),(0,b.jsx)("span",{children:"Ukończono"})]})]}),o.videoUrl&&(0,b.jsx)("div",{className:"aspect-video bg-slate-900 rounded-xl mb-6 overflow-hidden shadow-md",children:o.videoUrl.includes("youtube")?(0,b.jsx)("iframe",{src:o.videoUrl.replace("watch?v=","embed/"),className:"w-full h-full",allowFullScreen:!0,title:"Video"}):(0,b.jsx)("div",{className:"flex items-center justify-center h-full text-white",children:(0,b.jsx)("a",{href:o.videoUrl,target:"_blank",className:"underline text-amber-400 hover:text-amber-300",children:"Zobacz video"})})}),(0,b.jsx)("div",{className:"prose prose-slate prose-headings:text-slate-900 max-w-none text-slate-700 mb-8 whitespace-pre-wrap leading-loose",children:o.content}),(0,b.jsx)("div",{className:"flex justify-end pt-6 border-t border-stone-100",children:u?(0,b.jsx)("button",{onClick:()=>m.push("/dashboard"),className:"px-6 py-3 bg-slate-100 text-slate-700 rounded-lg hover:bg-slate-200 font-bold transition-colors",children:"Wróć do listy"}):(0,b.jsxs)("button",{onClick:D,disabled:!w,className:`flex items-center space-x-2 px-8 py-3 rounded-lg font-bold transition-all
                        ${w?"bg-amber-600 text-white hover:bg-amber-700 shadow-lg transform hover:-translate-y-1":"bg-stone-200 text-stone-400 cursor-not-allowed"}`,children:[(0,b.jsx)("span",{children:"Oznacz jako ukończone"}),(0,b.jsx)(j,{className:"h-5 w-5"})]})})]})]}):(0,b.jsx)("div",{children:"Ładowanie..."})}a.s(["default",()=>l],73853)}];

//# sourceMappingURL=app_chapter_%5Bid%5D_page_tsx_6f9a2fac._.js.map