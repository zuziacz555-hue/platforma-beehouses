(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,22369,e=>{"use strict";var t=e.i(43476),r=e.i(71645),a=e.i(4427),s=e.i(97815),l=e.i(18566),n=e.i(75254);let c=(0,n.default)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),d=(0,n.default)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),i=(0,n.default)("arrow-right",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);var o=e.i(22016);function u(){let e,{user:n,loading:u}=(0,s.useAuth)(),h=(0,l.useRouter)(),m=(0,l.useParams)(),[x,p]=(0,r.useState)(null),[b,f]=(0,r.useState)(180),[g,v]=(0,r.useState)(0),[y,j]=(0,r.useState)(!1),[w,N]=(0,r.useState)(!1),k=(0,r.useRef)(null),z=(0,r.useRef)(null);(0,r.useEffect)(()=>(u||n||h.push("/login"),n&&m.id&&S(),()=>{k.current&&clearInterval(k.current),z.current&&clearInterval(z.current)}),[n,u,m.id]);let S=async()=>{try{let e=m.id,[t,r]=await Promise.all([a.default.get(`/chapters/${e}`),a.default.get("/progress")]);p(t.data);let s=r.data.find(t=>t.chapterId===parseInt(e));if(s)if(j(s.completed),s.completed)N(!0),f(0);else{v(s.timeSpent);let e=Math.max(0,180-s.timeSpent);f(e),0===e?N(!0):I()}else I()}catch(e){console.error(e)}},I=()=>{k.current=setInterval(()=>{f(e=>e<=1?(N(!0),k.current&&clearInterval(k.current),0):e-1)},1e3),z.current=setInterval(()=>{U(10)},1e4)},U=async e=>{try{await a.default.post("/progress/update",{chapterId:m.id,timeIncrement:e})}catch(e){console.error("Progress save fail",e)}},P=async()=>{try{await a.default.post("/progress/complete",{chapterId:m.id}),j(!0),h.push("/dashboard")}catch(e){alert("Jeszcze nie minęło wystarczająco dużo czasu lub błąd serwera.")}};return x?(0,t.jsxs)("div",{className:"max-w-4xl mx-auto space-y-8 pt-32 pb-20 px-6",children:[(0,t.jsx)(o.default,{href:"/dashboard",className:"text-amber-600 hover:text-amber-700 hover:underline font-medium inline-flex items-center",children:"← Powrót do kursu"}),(0,t.jsxs)("div",{className:"bg-white p-8 rounded-2xl shadow-lg border border-stone-200",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,t.jsx)("h1",{className:"text-3xl font-bold text-slate-900",children:x.title}),!y&&(0,t.jsxs)("div",{className:`flex items-center space-x-2 px-4 py-2 rounded-full font-mono text-lg shadow-sm
                    ${w?"bg-green-100 text-green-700 ring-1 ring-green-200":"bg-amber-100 text-amber-800 ring-1 ring-amber-200"}`,children:[(0,t.jsx)(c,{className:"h-5 w-5"}),(0,t.jsx)("span",{children:w?"Czas minął!":(e=Math.floor(b/60),`${e}:${(b%60).toString().padStart(2,"0")}`)})]}),y&&(0,t.jsxs)("div",{className:"flex items-center space-x-2 px-4 py-2 bg-green-100 text-green-700 rounded-full ring-1 ring-green-200",children:[(0,t.jsx)(d,{className:"h-5 w-5"}),(0,t.jsx)("span",{children:"Ukończono"})]})]}),x.videoUrl&&(0,t.jsx)("div",{className:"aspect-video bg-slate-900 rounded-xl mb-6 overflow-hidden shadow-md",children:x.videoUrl.includes("youtube")?(0,t.jsx)("iframe",{src:x.videoUrl.replace("watch?v=","embed/"),className:"w-full h-full",allowFullScreen:!0,title:"Video"}):(0,t.jsx)("div",{className:"flex items-center justify-center h-full text-white",children:(0,t.jsx)("a",{href:x.videoUrl,target:"_blank",className:"underline text-amber-400 hover:text-amber-300",children:"Zobacz video"})})}),(0,t.jsx)("div",{className:"prose prose-slate prose-headings:text-slate-900 max-w-none text-slate-700 mb-8 whitespace-pre-wrap leading-loose",children:x.content}),(0,t.jsx)("div",{className:"flex justify-end pt-6 border-t border-stone-100",children:y?(0,t.jsx)("button",{onClick:()=>h.push("/dashboard"),className:"px-6 py-3 bg-slate-100 text-slate-700 rounded-lg hover:bg-slate-200 font-bold transition-colors",children:"Wróć do listy"}):(0,t.jsxs)("button",{onClick:P,disabled:!w,className:`flex items-center space-x-2 px-8 py-3 rounded-lg font-bold transition-all
                        ${w?"bg-amber-600 text-white hover:bg-amber-700 shadow-lg transform hover:-translate-y-1":"bg-stone-200 text-stone-400 cursor-not-allowed"}`,children:[(0,t.jsx)("span",{children:"Oznacz jako ukończone"}),(0,t.jsx)(i,{className:"h-5 w-5"})]})})]})]}):(0,t.jsx)("div",{children:"Ładowanie..."})}e.s(["default",()=>u],22369)}]);